version: "3.8"

services:
  telegram-monitor:
    image: tomatoknight/telethon-monitor:latest
    build:
      context: .
      dockerfile: Dockerfile
    container_name: telegram-code-monitor
    restart: unless-stopped
    environment:
      - TELEGRAM_API_ID=${TELEGRAM_API_ID}
      - TELEGRAM_API_HASH=${TELEGRAM_API_HASH}
      - BASE_SERVICE_URL=${BASE_SERVICE_URL}
      # Telegram 客户端专用代理配置
      - TELEGRAM_PROXY_TYPE=${TELEGRAM_PROXY_TYPE:-}
      - TELEGRAM_PROXY_ADDR=${TELEGRAM_PROXY_ADDR:-}
      - TELEGRAM_PROXY_PORT=${TELEGRAM_PROXY_PORT:-}
      - TELEGRAM_PROXY_USERNAME=${TELEGRAM_PROXY_USERNAME:-}
      - TELEGRAM_PROXY_PASSWORD=${TELEGRAM_PROXY_PASSWORD:-}
      - TELEGRAM_PROXY_RDNS=${TELEGRAM_PROXY_RDNS:-true}
    volumes:
      # 持久化session文件
      - ./data:/app/data
      # 持久化日志文件
      - ./logs:/app/logs
    env_file:
      - .env

volumes:
  telegram-data:
    driver: local
  telegram-logs:
    driver: local
